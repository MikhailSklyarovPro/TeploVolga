# Header Navigation Module

## Описание

Модуль `header.js` реализует интерактивное поведение навигационного меню в шапке сайта. При наведении курсора на пункты главного меню автоматически отображается соответствующее подменю.

## Возможности

- ✅ Автоматическое связывание пунктов меню с подменю через `id` и `data-sub-menu`
- ✅ Плавное появление и скрытие подменю при наведении
- ✅ Умная задержка скрытия для удобства пользователя
- ✅ Универсальная реализация для всех страниц сайта
- ✅ Гибкая конфигурация через опции
- ✅ Полная поддержка множественных подменю

## Структура HTML

### Требования к разметке

Для корректной работы модуля HTML должен иметь следующую структуру:

```html
<header class="header">
  <!-- Главное меню -->
  <div class="header__main-menu">
    <nav>
      <ul>
        <li>
          <!-- Пункт меню с обязательным атрибутом id -->
          <a id="heating-networks" href="...">Теплосети</a>
        </li>
        <li>
          <a id="heat-generation" href="...">Генерация тепла</a>
        </li>
        <!-- Другие пункты меню -->
      </ul>
    </nav>
  </div>

  <!-- Контейнер подменю -->
  <div class="header__sub-menu">
    <!-- Подменю с атрибутом data-sub-menu, соответствующим id пункта меню -->
    <nav data-sub-menu="heating-networks">
      <ul>
        <li><a href="...">Подпункт 1</a></li>
        <li><a href="...">Подпункт 2</a></li>
      </ul>
    </nav>

    <nav data-sub-menu="heat-generation">
      <ul>
        <li><a href="...">Подпункт 1</a></li>
        <li><a href="...">Подпункт 2</a></li>
      </ul>
    </nav>

    <!-- Другие подменю -->
  </div>
</header>
```

### Важные правила разметки

1. **ID пунктов меню**: Каждый пункт главного меню должен иметь уникальный `id`
2. **Атрибут data-sub-menu**: Каждое подменю должно иметь атрибут `data-sub-menu`, значение которого совпадает с `id` соответствующего пункта главного меню
3. **Контейнер подменю**: Все подменю должны находиться внутри элемента с классом `header__sub-menu`

## Связывание меню и подменю

Связь между пунктами меню и подменю осуществляется через атрибуты:

```html
<!-- Пункт главного меню -->
<a id="heating-networks" href="...">Теплосети</a>

<!-- Соответствующее подменю -->
<nav data-sub-menu="heating-networks">
  <!-- Содержимое подменю -->
</nav>
```

## CSS стили

Для корректной работы необходимо добавить следующие стили:

```css
/* Скрытие подменю по умолчанию */
.header__sub-menu {
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.3s ease,
    visibility 0.3s ease;
}

/* Видимое состояние подменю */
.header__sub-menu--visible {
  opacity: 1;
  visibility: visible;
}

/* Скрытие отдельных подменю (управляется через display: none/flex) */
.header__sub-menu nav {
  display: none;
}
```

## Подключение модуля

Добавьте скрипт в конец HTML документа перед закрывающим тегом `</body>`:

```html
<!-- Другие скрипты -->
<script src="./js/header.js"></script>
</body>
```

## Использование

### Базовое использование (автоматическая инициализация)

Модуль автоматически инициализируется при загрузке страницы. Никакой дополнительный код не требуется.

```javascript
// Ничего не нужно делать - модуль запускается автоматически!
```

### Расширенное использование с кастомными настройками

Если вам нужно изменить настройки по умолчанию:

```javascript
// Создание экземпляра с кастомными настройками
const customHeader = new HeaderNavigation({
  headerSelector: '.my-custom-header',
  mainMenuSelector: '.my-main-menu nav',
  subMenuSelector: '.my-sub-menu',
  activeClass: 'is-visible',
  hideDelay: 300,
});
```

## Конфигурация

### Доступные опции

| Параметр           | Тип    | По умолчанию                  | Описание                                         |
| ------------------ | ------ | ----------------------------- | ------------------------------------------------ |
| `headerSelector`   | string | `'.header'`                   | CSS селектор для шапки сайта                     |
| `mainMenuSelector` | string | `'.header__main-menu nav'`    | CSS селектор для главного меню                   |
| `subMenuSelector`  | string | `'.header__sub-menu'`         | CSS селектор для контейнера подменю              |
| `menuItemSelector` | string | `'[id]'`                      | CSS селектор для пунктов меню (элементы с id)    |
| `subMenuAttribute` | string | `'data-sub-menu'`             | Атрибут для связи подменю с пунктами меню        |
| `activeClass`      | string | `'header__sub-menu--visible'` | Класс для активного состояния контейнера подменю |
| `hideDelay`        | number | `200`                         | Задержка перед скрытием подменю в миллисекундах  |

### Пример конфигурации

```javascript
const header = new HeaderNavigation({
  headerSelector: '.site-header',
  hideDelay: 500, // Увеличенная задержка скрытия
  activeClass: 'submenu-active',
});
```

## API методы

### Публичные методы

```javascript
const header = new HeaderNavigation();

// Показать конкретное подменю
header.showSubMenu('heating-networks');

// Скрыть все подменю
header.hideAllSubMenus();

// Уничтожить экземпляр (удалить обработчики)
header.destroy();
```

## Логика работы

1. **Наведение на пункт меню**: Модуль считывает `id` пункта меню и ищет подменю с соответствующим значением `data-sub-menu`
2. **Показ подменю**: Найденное подменю становится видимым, все остальные подменю скрываются
3. **Задержка скрытия**: При уходе курсора с пункта меню есть задержка (по умолчанию 200мс), чтобы пользователь мог переместить курсор на подменю
4. **Наведение на подменю**: Если пользователь навел курсор на подменю, таймер скрытия отменяется
5. **Скрытие**: Подменю скрывается при уходе курсора со всей шапки или по истечении таймера

## Поддержка множественных страниц

Модуль полностью универсален и работает на всех страницах сайта без изменений кода. Достаточно:

1. Подключить скрипт на каждой странице
2. Следовать структуре HTML с правильными атрибутами
3. Добавить необходимые CSS стили

## Отладка

Модуль выводит информационные сообщения в консоль:

- ✅ `HeaderNavigation: Модуль успешно инициализирован` - успешная инициализация
- ⚠️ `HeaderNavigation: Не удалось найти необходимые элементы` - проблемы с поиском DOM элементов
- ⚠️ `HeaderNavigation: Подменю с data-sub-menu="..." не найдено` - отсутствует подменю для пункта меню

## Совместимость

- ✅ Современные браузеры (Chrome, Firefox, Safari, Edge)
- ✅ IE11+ (с полифиллами для Array.from)
- ✅ Мобильные браузеры

## Производительность

- Использует делегирование событий для оптимальной производительности
- Минимальные манипуляции с DOM
- Эффективная работа с множественными подменю

## Примеры использования

### Пример 1: Стандартная шапка

```html
<header class="header">
  <div class="header__main-menu">
    <nav>
      <ul>
        <li><a id="about" href="/about">О компании</a></li>
        <li><a id="services" href="/services">Услуги</a></li>
        <li><a id="contacts" href="/contacts">Контакты</a></li>
      </ul>
    </nav>
  </div>

  <div class="header__sub-menu">
    <nav data-sub-menu="about">
      <ul>
        <li><a href="/about/history">История</a></li>
        <li><a href="/about/team">Команда</a></li>
      </ul>
    </nav>

    <nav data-sub-menu="services">
      <ul>
        <li><a href="/services/consulting">Консалтинг</a></li>
        <li><a href="/services/development">Разработка</a></li>
      </ul>
    </nav>
  </div>
</header>

<script src="./js/header.js"></script>
```

### Пример 2: Программное управление

```javascript
// Получить доступ к экземпляру через window
const navigation = window.HeaderNavigation;

// Создать новый экземпляр с настройками
const myNav = new navigation({
  hideDelay: 300,
});

// Показать конкретное подменю программно
myNav.showSubMenu('services');

// Скрыть все подменю
setTimeout(() => {
  myNav.hideAllSubMenus();
}, 3000);
```

## Устранение неполадок

### Подменю не отображается

1. Проверьте, что у пункта меню есть атрибут `id`
2. Убедитесь, что значение `data-sub-menu` совпадает с `id`
3. Проверьте консоль браузера на наличие ошибок
4. Убедитесь, что CSS стили подключены

### Подменю не скрывается

1. Проверьте правильность CSS классов
2. Убедитесь, что не переопределены стили `display` в других местах
3. Проверьте параметр `hideDelay` - возможно он слишком большой

### Конфликт с другими скриптами

Модуль использует IIFE (немедленно вызываемое функциональное выражение) для изоляции и не загрязняет глобальную область видимости, за исключением экспорта класса `HeaderNavigation` в `window`.

## Лицензия

Модуль разработан для внутреннего использования проектом TeploVolga.

## Поддержка

При возникновении проблем или вопросов обращайтесь к команде разработки TeploVolga.

---

**Версия**: 1.0.0
**Последнее обновление**: 2025
**Автор**: TeploVolga Development Team
