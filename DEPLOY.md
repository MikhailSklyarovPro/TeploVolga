# Инструкция по публикации сайта

## Проблемы, которые были решены

1. **Картинки не загружались** - использовались абсолютные пути (`/assets/`) вместо относительных (`./assets/`)
2. **Страницы не находились** - Vite собирал только главную страницу, но не остальные HTML-файлы из папки `pages/`
3. **WebP файлы не загружаются на IIS** - IIS по умолчанию не знает MIME-тип для `.webp` файлов

## Изменения в конфигурации

В файле `vite.config.js` добавлено:

- `base: './'` - использование относительных путей
- Автоматический поиск всех HTML-файлов через `glob`
- Настройка `rollupOptions.input` для сборки многостраничного приложения

## Как публиковать сайт

### 1. Соберите проект

```bash
npm run build
```

### 2. Загрузите папку `dist` на сервер

Загрузите **ВСЁ содержимое** папки `dist/` в корень вашего веб-сервера:

- `index.html` - главная страница
- `web.config` - **ОБЯЗАТЕЛЬНО!** Конфигурация для IIS (настройка MIME-типов)
- `assets/` - все ресурсы (картинки, CSS, JS, видео, шрифты)
- `pages/` - все внутренние страницы

⚠️ **ВАЖНО для IIS:** Файл `web.config` **ОБЯЗАТЕЛЬНО** должен быть загружен! Без него `.webp` файлы не будут работать!

### 3. Структура на сервере должна выглядеть так:

```
http://172.16.48.52:8087/
├── index.html           (главная страница)
├── web.config          ⚠️ ОБЯЗАТЕЛЬНО для IIS!
├── assets/              (все ресурсы)
│   ├── *.webp          (картинки)
│   ├── *.css           (стили)
│   ├── *.js            (скрипты)
│   ├── *.webm          (видео)
│   └── *.ttf           (шрифты)
└── pages/               (внутренние страницы)
    ├── heating-networks/
    ├── heat-generation/
    ├── avtozavodskaya-tpp/
    ├── factory-networks/
    ├── ese-kuban/
    ├── home/
    └── op-yaroslavl/
```

## Проверка работоспособности

### Локально (для тестирования)

```bash
cd dist
python -m http.server 3000
```

Откройте: `http://localhost:3000/index.html`

### На сервере

Откройте: `http://172.16.48.52:8087/index.html`

Проверьте:

1. ✅ Картинки загружаются
2. ✅ Видео работает
3. ✅ Переходы по ссылкам на внутренние страницы работают
4. ✅ Стили применяются корректно

## Важно!

- **ВСЕГДА** собирайте проект перед публикацией: `npm run build`
- **НЕ публикуйте** папку `src/` - только `dist/`
- **Убедитесь**, что на сервере загружены ВСЕ файлы и папки из `dist/`
- **ОБЯЗАТЕЛЬНО загрузите файл `web.config`** - без него IIS не будет отдавать `.webp` файлы!

## Решение проблемы с WebP на IIS

### Почему картинки не загружаются на IIS?

IIS (Internet Information Services) **по умолчанию не знает** о MIME-типе для файлов `.webp`.
Когда браузер запрашивает файл `image.webp`, IIS не понимает, что это за тип файла, и возвращает **404 ошибку**.

### Решение

Файл `web.config` в папке `dist/` настраивает IIS для работы с `.webp` файлами:

- Добавляет MIME-тип `image/webp` для расширения `.webp`
- Также настраивает `.webm` (видео), `.ttf`, `.woff`, `.woff2` (шрифты)
- Включает сжатие для оптимизации загрузки

### Проверка после публикации

1. Убедитесь, что файл `web.config` загружен на сервер
2. Откройте DevTools (F12) в браузере
3. Перейдите на вкладку Network
4. Обновите страницу (Ctrl+F5)
5. Проверьте, что `.webp` файлы загружаются со статусом **200 OK**, а не 404

### Альтернативное решение (если нет доступа к web.config)

Если у вас нет прав на загрузку `web.config`, попросите администратора сервера добавить MIME-тип в IIS Manager:

1. Откройте IIS Manager
2. Выберите ваш сайт
3. Откройте "MIME Types"
4. Добавьте новый тип:
   - Расширение: `.webp`
   - MIME-тип: `image/webp`
5. Перезапустите сайт
